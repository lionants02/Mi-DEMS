{
  "openapi": "3.0.2",
  "info": {
    "title": "Mi-DEMS openapi doc",
    "version": "1_07-06-2024",
    "description": "api สำหรับให้ภายนอกเชื่อมต่อกับระบบ Mi-DEMS"
  },
  "servers": [
    {
      "url": "{base_url}",
      "description": "ปรับแต่ง url ได้เอง",
      "variables": {
        "base_url": {
          "default": "http://localhost:8080/v1"
        }
      }
    },
    {
      "url": "http://localhost:8080/v1",
      "description": "สำหรับทดสอบ"
    }
  ],
  "security": [
    {
      "Authorization": []
    }
  ],
  "components": {
    "securitySchemes": {
      "Authorization": {
        "type": "apiKey",
        "name": "Authorization",
        "in": "header",
        "description": "ปรับแต่งรูปแบบ Key ภายใต้ Authorization http header ใต้ตามต้องการ <br> Example Bearer xxxxx <br> Example api-key aabbcc"
      }
    },
    "schemas": {
      "gps": {
        "type": "object",
        "description": "ข้อมูลเกี่ยวกับตำแหน่งพิกัด GPS",
        "properties": {
          "lat": {
            "type": "number",
            "description": "พิกัดละติจูด",
            "example": 14.077885847295322
          },
          "lng": {
            "type": "number",
            "description": "พิกัดลองติจูด",
            "example": 100.60228228571454
          },
          "accuracy": {
            "type": "number",
            "description": "ค่าความแม่นยำ +- หน่วยเป็น เมตร",
            "example": 10
          }
        }
      },
      "configRoom": {
        "type": "object",
        "description": "ชุดข้อมูลสั่งเปิดเคส ไปยังทีมรถที่ต้องการ",
        "properties": {
          "patient": {
            "type": "array",
            "description": "รายการผู้ป่วย",
            "items": {
              "type": "object",
              "properties": {
                "patientId": {
                  "type": "string",
                  "description": "รหัสผู้ป่วย",
                  "example": "p12235"
                },
                "idc_level": {
                  "type": "string",
                  "description": "รหัสความรุ่นแรง ตามตาราง icd_level Master",
                  "example": "2"
                }
              }
            }
          },
          "teamLevel": {
            "type": "string",
            "description": "ระดับของทีม",
            "example": "ALS"
          },
          "gpsWebView": {
            "type": "string",
            "description": "ดูพิกัด GPS แบบ webView"
          },
          "GeoJSONApi": {
            "type": "string",
            "description": "ข้อมูลเพื่อดึงข้อมูลตำแหน่งในรูปแบบ GeoJSON"
          },
          "createAt": {
            "type": "string",
            "description": "สร้างข้อมูลเมื่อ ไม่ต้องส่งค่านี้เข้ามา จะถูกสร้างโดยระบบ",
            "example": "2023-03-10T22:08:51.718584300"
          }
        }
      },
      "conferenceRoom": {
        "type": "object",
        "description": "ข้อมูลห้องประชุมฉุกเฉิน",
        "properties": {
          "roomId": {
            "type": "string",
            "description": "รหัส id ของห้องประชุมในการสร้งแต่ละครั้ง รหัสนี้จะไม่ซ้ำกัน",
            "example": "c11235"
          },
          "link": {
            "type": "string",
            "description": "ลิงก์หน้าเว็บห้องประชุมเฉุกเฉิน",
            "example": "https://mi-dems-con/c11235"
          },
          "createAt": {
            "type": "string",
            "description": "สร้างข้อมูลเมื่อ ไม่ต้องส่งค่านี้เข้ามา จะถูกสร้างโดยระบบ",
            "example": "2023-03-10T22:08:51.718584300"
          },
          "detail": {
            "type": "object",
            "description": "ข้อมูลรายละเอียดอื่นๆ",
            "properties": {
              "case": {
                "description": "ข้อมูลเกี่ยวกับเคส",
                "$ref": "#/components/schemas/configRoom"
              }
            }
          }
        }
      }
    }
  },
  "paths": {
    "/room/{teamId}": {
      "post": {
        "tags": ["ห้องประชุม"],
        "summary": "สร้างห้องประชุม Mi-DEMS",
        "description": "สร้างห้องประชุมในระบบ Mi-DEMS โดยระบบจะส่งการแจ้งเตือนรับงานฉุกเฉินไปยังทุกคนในทีมที่ระบุ",
        "parameters": [
          {
            "name": "teamId",
            "description": "รหัสทีมที่ออกปฏิบัติการ",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "default":"txx1123"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/configRoom"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "ส่งคืนข้อมูลห้องประชุม",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/conferenceRoom"
                }
              }
            }
          },
          "401": {
            "description": "Authorization ผิด หรือ ไม่ได้ระบุ Authorization"
          }
        }
      }
    }
  }
}
